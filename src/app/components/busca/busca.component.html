<div class="container container-busca">
    
  <!-- Caixa de Pesquisa -->
  <div class="container-pesquisa row">

      <div class="scroller scroller-left"><i class="glyphicon glyphicon-chevron-left"></i></div>
      <div class="scroller scroller-right"><i class="glyphicon glyphicon-chevron-right"></i></div>
      <div class="col-md-8 col-md-offset-2 text-center abas-pesquisa">
        <ul class="nav nav-pills aba">
          <li role="presentation" [ngClass]="{'active': pesquisaPor === 'projetos'}"><a (click)="onTrocaPesquisaPor('projetos')">Projetos <span class="fa fa-file-text" aria-hidden="true"></span></a></li>
          <li role="presentation" [ngClass]="{'active': pesquisaPor === 'propostas'}"><a (click)="onTrocaPesquisaPor('propostas')">Propostas <span class="fa fa-file" aria-hidden="true"></span></a></li>
          <li role="presentation" [ngClass]="{'active': pesquisaPor === 'proponentes'}"><a (click)="onTrocaPesquisaPor('proponentes')">Proponentes <span class="fa fa-user" aria-hidden="true"></span></a></li>
          <li role="presentation" [ngClass]="{'active': pesquisaPor === 'incentivadores'}"><a (click)="onTrocaPesquisaPor('incentivadores')">Incentivadores <span class="fa fa-dollar" aria-hidden="true"></span></a></li>
          <li role="presentation" [ngClass]="{'active': pesquisaPor === 'fornecedores'}"><a (click)="onTrocaPesquisaPor('fornecedores')">Fornecedores <span class="fa fa-archive" aria-hidden="true"></span></a></li>
        </ul>
      </div>

    <div class="row">
      <div class="panel panel-default col-md-8 col-md-offset-2">
        
        <!-- Busca Simples ============================================================== -->
        <div *ngIf="!buscaAvancada" class="panel-body input-group" [ngSwitch]="pesquisaPor">
          <input *ngSwitchCase="'projetos'" type="text" [(ngModel)]="queriesDeProjetos['nome']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" placeholder="Pesquisar por {{ pesquisaPor }}">
          <input *ngSwitchCase="'propostas'" type="text" [(ngModel)]="queriesDePropostas['nome']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" placeholder="Pesquisar por {{ pesquisaPor }}">
          <input *ngSwitchCase="'proponentes'" type="text" [(ngModel)]="queriesDeProponentes['nome']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" placeholder="Pesquisar por {{ pesquisaPor }}">
          <input *ngSwitchCase="'incentivadores'" type="text" [(ngModel)]="queriesDeIncentivadores['nome']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" placeholder="Pesquisar por {{ pesquisaPor }}">
          <input *ngSwitchCase="'fornecedores'" type="text" [(ngModel)]="queriesDeFornecedores['nome']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" placeholder="Pesquisar por {{ pesquisaPor }}">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit" (click)="onRealizarBusca()"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
          </span>
        </div>

        <!-- Busca Avançada ============================================================ -->
        <div *ngIf="buscaAvancada" class="panel-body form-group">
          <div class="row">
            <div class="input col-sm-5">
              <input type="text" [(ngModel)]="queries['nome']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" [ngClass]="{'cheio': queries['nome'] !== undefined && queries['nome'] !== null && queries['nome'] !== ''}">
              <div class="form-control-placeholder">Nome</div>
            </div>
            <div class="input col-sm-2">
              <input type="text" [(ngModel)]="queries['PRONAC']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" [ngClass]="{'cheio': queries['PRONAC'] !== undefined && queries['PRONAC'] !== null && queries['PRONAC'] !== ''}">
              <div class="form-control-placeholder">PRONAC</div>
            </div>
            <div class="input col-sm-5">
              <input type="text" [(ngModel)]="queries['proponente']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" [ngClass]="{'cheio': queries['proponente'] !== undefined && queries['proponente'] !== null && queries['proponente'] !== ''}">
              <div class="form-control-placeholder">Nome do Proponente</div>
            </div>
          </div>
          <div class="row">
            <div class="input col-sm-6">
              <input type="text" [(ngModel)]="queries['municipio']" (keypress)="onRealizarBuscaComEnter($event)" class="form-control" [ngClass]="{'cheio': queries['municipio'] !== undefined && queries['municipio'] !== null && queries['municipio'] !== ''}">
              <div class="form-control-placeholder">Município</div>
            </div>
            <div class="input col-sm-6">
              <div class="alert alert-danger">AINDA EM IMPLEMENTAÇÃO</div>
            </div>
          </div>
        </div>

        <!-- Footer da Busca ============================================================== -->
        <div class="panel-footer">
          <button class="btn btn-default" (click)="buscaAvancada = !buscaAvancada">{{ buscaAvancada ? 'Busca Simples' : 'Busca Avançada' }}</button>
          <!--<div class="chip-wrapper" *ngFor="let key of keys(queries)">
            <div class="chip" *ngIf="queries[key] != null && queries[key] != '' && queries[key] != undefined" >
              <div class="chip-tag">{{key}}</div>
                {{queries[key]}}
              <span class="glyphicon glyphicon-remove" aria-hidden="true" (click)='removeQuery(key)'></span>
            </div>
          </div>-->
          <button *ngIf="buscaAvancada" class="btn btn-default pull-right" type="submit" (click)="onRealizarBusca()">Buscar <span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
        </div>

      </div>
    </div>
  </div>

  <div [@subirRespostas]='subirRespostasEstado' class="container-respostas">
    <div class="col-lg-8 col-md-12 col-lg-offset-2" [ngSwitch]="pesquisaPor" *ngIf="!buscaSemResultados && !carregandoDados">

    <!-- ORDENAÇÃO, QUANDO DISPONÍVEL =================================================================================-->
      <div *ngIf="keys(ordenarPorQueries).length > 0">
        <span>Ordenar por: </span>
        <div class="btn-group" dropdown>
          <button class="btn btn-default" type="button" id="seletorOrdenarPor" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"  dropdownToggle>
            {{ ordenarPorQueries[ordenarPor] }}
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" aria-labelledby="seletorOrdenarPor">
            <li *ngFor="let key of keys(ordenarPorQueries)" role="menuitem"><a (click)="ordenarPor = key; onRealizarBusca();" class="dropdown-item">{{ ordenarPorQueries[key] }}</a></li>
          </ul>
        </div>
        <button (click)="ordenarDesc = !ordenarDesc; onRealizarBusca();" type="button" class="btn btn-default" aria-label="Left Align">
          <span class="glyphicon glyphicon-sort-by-attributes" [ngClass]="{'glyphicon-sort-by-attributes': !ordenarDesc, 'glyphicon-sort-by-attributes-alt': ordenarDesc }" aria-hidden="true"></span>
        </button>
      </div>

      <br>
      
      <alert type="success">Exibindo {{ numeroDeItems }} de um total de {{ totalDeItems }} {{ pesquisaPor }} {{ pesquisaPor==='propostas'?'encontradas':'encontrados' }}.</alert>   
     
      <!-- GRADE OU LISTA DE RESULTADOS =================================================================================-->
      <masonry [options]="{ transitionDuration: '0.5s' }" *ngSwitchCase="'projetos'" >
        <masonry-brick *ngFor="let projeto of listaProjetos;" class="card col-md-6">

          <div class="panel panel-default">
            <div class="panel-heading">{{ projeto.nome }}</div>
            <div class="panel-body">
              <div class="col-md-6"><p>Proponenete: </p><h5>{{ projeto.proponente}}</h5></div> 
              <div class="col-md-6"><p>CGCCPF: </p><h5>{{ projeto.cgccpf}}</h5></div> 
              <div class="col-lg-12" *ngIf="projeto.isResumoEscondido"><p>Resumo: </p><h5>{{ projeto.resumo }}</h5></div>
              <div class="col-md-12">
                <button (click)="projeto.isResumoEscondido = !projeto.isResumoEscondido"
                          type="button" 
                          class="btn btn-default">Resumo <span class="glyphicon" [ngClass]="{'glyphicon-triangle-bottom': !projeto.isResumoEscondido, 'glyphicon-triangle-top': projeto.isResumoEscondido }" aria-hidden="true"></span></button>
                <button [routerLink]="['/projetos', projeto.PRONAC]" 
                         type="button" 
                         class="btn btn-primary">Ver Projeto</button>
              </div>
            </div>      
          </div>

        </masonry-brick>
      </masonry>

      <div *ngSwitchCase="'propostas'">
        <div *ngFor="let proposta of listaPropostas" class="card col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading">{{ proposta.nome }}</div> 
            <div class="panel-body">
              <div class="col-sm-3"><button [routerLink]="['/propostas', proposta.id]" 
                                              type="button" 
                                              class="btn btn-primary" >Ver Proposta</button></div>
            </div>
          </div>
        </div>
      </div>
      <div *ngSwitchCase="'proponentes'">
        <div *ngFor="let proponente of listaProponentes" class="card col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading">{{ proponente.nome }}</div> 
            <div class="panel-body">
              <div class="col-sm-9"><p>CGCCPF: </p><h4>{{ proponente.cgccpf }}</h4></div> 
              <div class="col-sm-3"><button [routerLink]="['/proponentes', dataFormatterService.extraiIdDaUrl(proponente._links.self)]" 
                                            type="button" 
                                            class="btn btn-primary" >Ver Proponente</button></div>
            </div>   
          </div>                                
        </div>
      </div>
      <div *ngSwitchCase="'incentivadores'">
        <div *ngFor="let incentivador of listaIncentivadores" class="card col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading">{{ incentivador.nome }}</div> 
            <div class="panel-body">
              <div class="col-sm-9"><p>cgccpf: </p><h4>{{ incentivador.cgccpf }}</h4></div>
              <div class="col-sm-3"><button [routerLink]="['/incentivadores', dataFormatterService.extraiIdDaUrl(incentivador._links.self)]" 
                                            type="button" 
                                            class="btn btn-primary" >Ver Incentivador</button></div>
            </div>
          </div>
        </div>
      </div>
      <div *ngSwitchCase="'fornecedores'">
        <div *ngFor="let fornecedor of listaFornecedores" class="card col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading">{{ fornecedor.nome }}</div> 
            <div class="panel-body">
              <div class="col-sm-9"><p>cgccpf: </p><h4>{{ fornecedor.cgccpf }}</h4></div>
            <div class="col-sm-3"><button [routerLink]="['/fornecedores', dataFormatterService.extraiIdDaUrl(fornecedor._links.self)]" 
                                            type="button" 
                                            class="btn btn-primary" >Ver Fornecedor</button></div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
  <sk-fading-circle [isRunning]="carregandoDados"></sk-fading-circle>

  <alert *ngIf="buscaSemResultados"type="danger">
    <p>Não encontramos {{ pesquisaPor }} com estes parâmetros de pesquisa :(</p>
    <p>Experimente mudar os termos de busca ou filtros aplicados.</p>
  </alert>
      
  <div class="text-center" *ngIf="(numeroDeItems < totalDeItems)">

    <pagination [totalItems]="totalDeItems" 
                (pageChanged)="paginaAtual = $event.page; carregarPagina(paginaAtual);" 
                [maxSize]=" maximoBotoes" 
                class="pagination-sm"
                [boundaryLinks]="true" 
                [rotate]="false"  
                [(ngModel)]="paginaAtual"></pagination>
  </div>

</div>